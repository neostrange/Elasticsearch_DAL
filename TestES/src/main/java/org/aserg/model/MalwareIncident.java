package org.aserg.model;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/**
 * This class represents the {@code Incident} where a malware has been
 * downloaded by the attacker.
 */
public class MalwareIncident extends Incident {

	private static Logger log = LoggerFactory.getLogger(MalwareIncident.class);

	/**
	 * Will store the malware hash.
	 */
	private String md5Hash;
	/**
	 * This will be the url through which malware was loaded.
	 */
	private String url;
	/**
	 * The file path for the malware binary.
	 */
	private String filePath;
	/**
	 * Session Id, in case of "kippo" malware download
	 */
	private String sessionId;
	/**
	 * Reference to the virustotal scan and its results.
	 */
	private VirusTotalScan vtScan;

	public MalwareIncident(String dateTime, String srcIP, int srcPort, String service, String dstIP, int dstPort,
			String protocol, Origin org, String md5Hash, String url, String filePath, String sessionId,
			VirusTotalScan vtScan) {
		super(dateTime, srcIP, srcPort, service, dstIP, dstPort, protocol, org);
		log.trace("Create new MalwareIncident instance with md5hash [{}], url [{}]", md5Hash, url);
		this.md5Hash = md5Hash;
		this.url = url;
		this.filePath = filePath;
		this.sessionId = sessionId;
		this.vtScan = vtScan;
	}

	public String getMd5Hash() {
		log.trace("Get md5Hash, returns [{}]", md5Hash);
		return md5Hash;
	}

	public void setMd5Hash(String hash) {
		log.trace("Set md5Hash to [{}]", hash);
		this.md5Hash = hash;
	}

	public String getUrl() {
		log.trace("Get url, returns [{}]", url);
		return url;
	}

	public void setUrl(String url) {
		log.trace("Set url to [{}]", url);
		this.url = url;
	}

	public String getFilePath() {
		log.trace("Get filePath, returns [{}]", filePath);
		return filePath;
	}

	public void setFilePath(String filePath) {
		log.trace("Set filePath to [{}]", filePath);
		this.filePath = filePath;
	}

	public String getSessionId() {
		log.trace("Get sessionId, returns [{}]", sessionId);
		return sessionId;
	}

	public void setSessionId(String sessionId) {
		log.trace("Set sessionId to [{}]", sessionId);
		this.sessionId = sessionId;
	}

	public VirusTotalScan getVtScan() {
		log.trace("Get vtScan, returns [{}]", vtScan);
		return vtScan;
	}

	public void setVtScan(VirusTotalScan virustotal) {
		log.trace("Set vtScan to [{}]", virustotal);
		this.vtScan = virustotal;
	}

}