package org.aserg.model;

import java.time.LocalDateTime;
import java.util.Date;

import org.elasticsearch.common.joda.time.DateTime;

/**
 * This class represents the {@code Incident} where a malware has been
 * downloaded by the attacker.
 */
public class MalwareIncident extends Incident {

	/**
	 * Will store the malware hash.
	 */
	private String md5Hash;
	/**
	 * This will be the url through which malware was loaded.
	 */
	private String url;
	/**
	 * The file path for the malware binary.
	 */
	private String filePath;
	/**
	 * Reference to the virustotal scan and its results.
	 */
	private VirusTotalScan vtScan;


	public MalwareIncident(String dateTime, String localHost, int localPort, String protocol, String remoteHost,
			int remotePort, String transport, String country, String md5Hash, String url, String filePath,
			VirusTotalScan vtScan) {
		super(dateTime, localHost, localPort, protocol, remoteHost, remotePort, transport, country);
		this.md5Hash = md5Hash;
		this.url = url;
		this.filePath = filePath;
		this.vtScan = vtScan;
	}


	/**
	 * Without filePath
	 * @param dateTime
	 * @param localHost
	 * @param localPort
	 * @param protocol
	 * @param remoteHost
	 * @param remotePort
	 * @param transport
	 * @param country
	 * @param md5Hash
	 * @param url
	 * @param vtScan
	 */
	public MalwareIncident(String dateTime, String localHost, int localPort, String protocol, String remoteHost,
			int remotePort, String transport, String country, String md5Hash, String url, VirusTotalScan vtScan) {
		super(dateTime, localHost, localPort, protocol, remoteHost, remotePort, transport, country);
		this.md5Hash = md5Hash;
		this.url = url;
		this.vtScan = vtScan;
	}


	public String getMd5Hash() {
		return md5Hash;
	}

	public void setMd5Hash(String hash) {
		this.md5Hash = hash;
	}

	public String getUrl() {
		return url;
	}

	public void setUrl(String url) {
		this.url = url;
	}

	public String getFilePath() {
		return filePath;
	}

	public void setFilePath(String filePath) {
		this.filePath = filePath;
	}

	public VirusTotalScan getVtScan() {
		return vtScan;
	}

	public void setVtScan(VirusTotalScan virustotal) {
		this.vtScan = virustotal;
	}

}